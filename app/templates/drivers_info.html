{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h1><i class="fas fa-user-tie me-2"></i>F1 Drivers Information</h1>
    <p class="lead">Browse through all Formula 1 drivers for the 2025 season</p>

    <!-- Filter Dropdowns -->
    <div class="row mb-4">
        <div class="col-md-6">
            <label for="teamFilter" class="form-label"><strong>Filter by Team:</strong></label>
            <select class="form-select" id="teamFilter" onchange="filterDrivers()">
                <option value="">-- All Teams --</option>
                {% for team in all_teams %}
                <option value="{{ team.team_id }}">{{ team.team_name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col-md-6">
            <label for="driverSelect" class="form-label"><strong>Select a Driver:</strong></label>
            <select class="form-select" id="driverSelect" onchange="filterByDriver()">
                <option value="">-- All Drivers --</option>
                {% for driver in all_drivers %}
                <option value="{{ driver.driver_id }}">{{ driver.first_name }} {{ driver.last_name }}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    <!-- Drivers Display -->
    <div class="row">
        {% for driver in all_drivers %}
        <div class="col-md-6 mb-4 driver-card" data-driver-id="{{ driver.driver_id }}" data-team-id="{{ driver.team_id }}">
            <div class="card h-100 driver-profile-card">
                {% if driver.photo_url %}
                    <div class="driver-photo-container">
                        <img src="{{ driver.photo_url }}" alt="{{ driver.first_name }} {{ driver.last_name }}" class="driver-photo">
                        <div class="driver-number-overlay">#{{ driver.driver_number }}</div>
                    </div>
                {% else %}
                    <div class="driver-photo-container">
                        <img src="https://via.placeholder.com/300x300?text={{ driver.first_name[0] }}{{ driver.last_name[0] }}" alt="{{ driver.first_name }} {{ driver.last_name }}" class="driver-photo">
                        <div class="driver-number-overlay">#{{ driver.driver_number }}</div>
                    </div>
                {% endif %}
                <div class="card-body">
                    <h3 class="driver-name">{{ driver.first_name }} {{ driver.last_name }}</h3>
                    <div class="driver-info">
                        <p class="mb-2"><span class="badge team-badge">{{ driver.team_name }}</span></p>
                        <p class="mb-1"><strong>Nationality:</strong> {{ driver.nationality }}</p>
                        <p class="mb-1"><strong>Date of Birth:</strong> {{ driver.date_of_birth.strftime('%B %d, %Y') if driver.date_of_birth else 'N/A' }}</p>
                    </div>
                    <a href="{{ url_for('drivers.show_drivers') }}" class="btn btn-primary btn-sm mt-3 w-100">
                        <i class="fas fa-edit me-1"></i>Manage Drivers
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
function filterDrivers() {
    var selectedTeam = document.getElementById('teamFilter').value;
    var driverCards = document.querySelectorAll('.driver-card');

    // Reset driver select
    document.getElementById('driverSelect').value = '';

    driverCards.forEach(function(card) {
        if (selectedTeam === '' || card.getAttribute('data-team-id') === selectedTeam) {
            card.style.display = 'block';
        } else {
            card.style.display = 'none';
        }
    });
}

function filterByDriver() {
    var selectedDriver = document.getElementById('driverSelect').value;
    var driverCards = document.querySelectorAll('.driver-card');

    // Reset team filter
    document.getElementById('teamFilter').value = '';

    driverCards.forEach(function(card) {
        if (selectedDriver === '' || card.getAttribute('data-driver-id') === selectedDriver) {
            card.style.display = 'block';
        } else {
            card.style.display = 'none';
        }
    });
}
</script>

<style>
    .driver-profile-card {
        position: relative;
    }

    .driver-photo-container {
        position: relative;
        background: linear-gradient(135deg, var(--f1-black) 0%, var(--f1-gray) 100%);
        height: 280px;
        overflow: hidden;
        display: flex;
        align-items: flex-end;
        justify-content: center;
    }

    .driver-photo {
        width: auto;
        height: 100%;
        object-fit: contain;
        transition: transform 0.3s ease;
    }

    .driver-profile-card:hover .driver-photo {
        transform: scale(1.05);
    }

    .driver-number-overlay {
        position: absolute;
        top: 15px;
        right: 15px;
        background-color: var(--f1-red);
        color: white;
        font-size: 1.5rem;
        font-weight: 700;
        padding: 8px 16px;
        border-radius: 4px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }

    .driver-name {
        font-size: 1.5rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: -0.5px;
        margin-bottom: 0.5rem;
        color: var(--f1-black);
    }

    .driver-info {
        font-size: 0.95rem;
        color: var(--f1-gray);
    }

    .team-badge {
        background-color: var(--f1-red);
        color: white;
        font-size: 0.875rem;
        font-weight: 600;
        padding: 6px 12px;
        border-radius: 4px;
    }

    .btn-primary.btn-sm {
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-size: 0.875rem;
    }
</style>
{% endblock %}
